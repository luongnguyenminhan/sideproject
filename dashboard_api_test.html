<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Dashboard API Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 2em; }
        .section { margin-bottom: 2em; }
        label { display: block; margin-top: 1em; }
        input, select, textarea { width: 100%; padding: 0.5em; margin-top: 0.2em; }
        button { margin-top: 1em; padding: 0.5em 1em; }
        pre { background: #f4f4f4; padding: 1em; border-radius: 4px; }
        .stat-box { display: inline-block; min-width: 180px; background: #e9f5ff; margin: 0.5em; padding: 1em 2em; border-radius: 8px; text-align: center; box-shadow: 0 2px 8px #0001; }
        .stat-title { font-size: 1.1em; color: #555; margin-bottom: 0.3em; }
        .stat-value { font-size: 2em; color: #0077cc; font-weight: bold; }
    </style>
</head>
<body>
    <h1>Dashboard API Test (localhost:8000/api/v1/dashboard)</h1>

    <div class="section">
        <label>Bearer Token (Authorization)<input type="text" id="bearerToken" placeholder="Paste Bearer token here"></label>
        <small>Chỉ cần dán nếu API yêu cầu xác thực</small>
    </div>

    <div class="section">
        <h2>Get Dashboard Statistics</h2>
        <button onclick="getDashboardStats()">Get Dashboard Stats</button>
        <div id="dashboardStatsResult"></div>
        <pre id="dashboardStatsRaw"></pre>
    </div>

    <script>
    const API_BASE = 'https://api.wc504.io.vn/api/v1/dashboard';

    function getAuthHeader() {
        const token = document.getElementById('bearerToken').value.trim();
        return token ? { 'Authorization': `Bearer ${token}` } : {};
    }

    function renderStats(stats) {
        if (!stats) return '<i>No data found.</i>';
        return `<div class='stat-box'><div class='stat-title'>User Count</div><div class='stat-value'>${stats.user_count ?? '-'}</div></div>` +
               `<div class='stat-box'><div class='stat-title'>Order Count</div><div class='stat-value'>${stats.order_count ?? '-'}</div></div>` +
               `<div class='stat-box'><div class='stat-title'>Total Revenue</div><div class='stat-value'>${stats.total_revenue ?? '-'}</div></div>`;
    }

    async function getDashboardStats() {
        const headers = getAuthHeader();
        const res = await fetch(`${API_BASE}/stats`, { headers });
        let text = await res.text();
        document.getElementById('dashboardStatsRaw').textContent = text;
        let html = '';
        try {
            const json = JSON.parse(text);
            html = renderStats(json?.data);
        } catch {
            html = `<pre>${text}</pre>`;
        }
        document.getElementById('dashboardStatsResult').innerHTML = html;
    }
    </script>
</body>
</html>
